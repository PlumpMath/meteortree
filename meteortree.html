<head>
	<title>GSAPP METEORTREE</title>
  <!--	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'> -->
  <!--	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css" /> -->
<!--	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script> 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script> -->
</head>

<body>
<div class="container">


  <div class='section-logo'>
    <img class='logo' src='/img/site-logo.jpg' />
{{> loginButtons}}
  {{#if currentUser}}
  <div class="admin-buttons">
{{ allicons }}
<form class="new-tutorial">
	ADD NEW TUTORIAL
    <input type="submit" />
  </form>
	<div class="discard-draft button">DISCARD DRAFT</div>
	<div class="save-draft button">SAVE DRAFT</div>
  </div>
  {{/if}}

  </div>

	<div class="section-tree">
		<div class="section-tree-inner">
			{{> sectiontree }}
			<div id="jsPlumbContainer"></div>
		</div>
	</div>

<div class="section-tutorial">
	<div class="section-tutorial-inner">
		<div class="tutorials">
		  {{#each tutorials}}
			{{> tutorial}}
		  {{/each}}
		</div>
	</div>
</div>


</div>
</body>

<template name="upload">
  <form class="update-icon">
	<input type="file" id="icon">
    <input type="submit" />
  </form>
</template>

<template name="sectiontree">
  {{#each nodes}}
	{{> node}}
  {{/each}}
</template> 

<template name="node">
<div class="node {{publishMode}} {{draftMode}}" style="position: absolute; top: {{ ypos }}px; left: {{ xpos }}px; " id={{_id}} >
	<div class="icon">{{{ nodeIcon }}}</div>
	<div class="title">{{ title }}</div>
	{{#if currentUser}}
		<div class="change-dep"><i class="fa fa-arrows-h fa-2x"></i></div>
	{{/if}}
</div>
</template>

<template name="step">
<div class="step {{new}}" id="{{_id}}">
	{{#if currentUser}}
	<div class="step-ui-menu">
		{{#if new}}
			<div class="new-button button"><i class="fa fa-plus-square fa-2x"></i> STEP</div>
		{{else}}
			<div class="sorthandle"><i class="fa fa-arrows fa-2x"></i></div>
			<div class="edit-button button"><i class="fa fa-pencil-square fa-2x"></i></div>
		{{/if}}
	</div>
	{{/if}}

	<div class="step-inner">
		{{#if currentUser}}
		<div class="edit-form">
			<button class="delete">DELETE</button>
			<form class="update-step">
				Description
				<input type="text" name="description" placeholder="description" value="{{description}}">
				Video URL
				<input type="text" name="video_url" placeholder="video_url" value="{{video_url}}">
				{{ tutorial_id }}
				<input type="submit" />
			</form>
		</div>
		{{/if}}
		<div class="step-description">
			{{ description }}
		</div>
		<div class="step-video">
			{{{ video_embedded }}}
		</div>
	</div>
</div>
</template>

<template name="tutorial">
	<div class="tutorial {{publishMode}}" id="{{ _id }}">
		<div class="header">
			<div class="draft-warning">DRAFT</div>
			<div class="header-inner">
				<div class="icon">{{{ nodeIcon }}}</div>
				<div class="title">{{ title }}</div>
			</div>
		</div>
		{{#if currentUser}}
		<div class="edit-button button">EDIT TUTORIAL</div>
		<div class="edit-form">
			{{ >upload tutorial_id = _id }}
			<button class="delete">DELETE</button>
			<form class="update-tutorial">
				Publish?
				<input type="checkbox" name="publishMode" value="publishMode" {{publishChecked}}><br>
				UPDATE
				<input type="text" name="title" placeholder="title" value="{{title}}">
				<input type="submit" />
			</form>
		</div>
		{{/if}}
		<div class="steps sortable">
		{{#each steps}}
			{{> step }}
		{{/each}}
		</div>
		{{> step tutorial_id =  _id  new="new"}}
		<div class="debug">
			{{ isPublished }}
			{{ createdAt }}
		</div>
	</div>
</template>


